{"paragraphs":[{"text":"%md\nSpark ML\n==================================\n","dateUpdated":"2017-11-11T09:31:14+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Spark ML</h1>\n"}]},"apps":[],"jobName":"paragraph_1510391055823_-2072307733","id":"20171103-004711_863647390","dateCreated":"2017-11-11T09:04:15+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14053"},{"text":"%md\n### Read data","dateUpdated":"2017-11-11T09:31:14+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Read data</h3>\n"}]},"apps":[],"jobName":"paragraph_1510391055823_-2072307733","id":"20171103-004752_1311859387","dateCreated":"2017-11-11T09:04:15+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14054"},{"text":"import org.apache.spark.sql.types._\n\nval df = spark.read.parquet(\"hdfs://ec2-54-234-74-28.compute-1.amazonaws.com/data/train.parquet\")\n    .select(\n        $\"Week\".cast(FloatType),\n        $\"SalesDepotID\".cast(FloatType),\n        $\"SalesChannelID\".cast(FloatType),\n        $\"RouteID\".cast(FloatType),\n        $\"ClientID\".cast(FloatType),\n        $\"ProductID\".cast(FloatType),\n        $\"Demand\".cast(FloatType)\n    )\n\ndf.show(7)","user":"anonymous","dateUpdated":"2017-11-11T09:31:14+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false},"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.sql.types._\n\ndf: org.apache.spark.sql.DataFrame = [Week: float, SalesDepotID: float ... 5 more fields]\n+----+------------+--------------+-------+---------+---------+------+\n|Week|SalesDepotID|SalesChannelID|RouteID| ClientID|ProductID|Demand|\n+----+------------+--------------+-------+---------+---------+------+\n| 9.0|      1531.0|           1.0| 2113.0|1874801.0|  33671.0|   1.0|\n| 9.0|      1531.0|           1.0| 2113.0|1874801.0|  35303.0|   5.0|\n| 9.0|      1531.0|           1.0| 2113.0|1938955.0|  30574.0|   4.0|\n| 9.0|      1531.0|           1.0| 2113.0|1985507.0|  30531.0|   8.0|\n| 9.0|      1531.0|           1.0| 2113.0|1985507.0|  30548.0|   4.0|\n| 9.0|      1531.0|           1.0| 2113.0|1985507.0|  36964.0|   0.0|\n| 9.0|      1531.0|           1.0| 2113.0|1991146.0|  30531.0|   4.0|\n+----+------------+--------------+-------+---------+---------+------+\nonly showing top 7 rows\n\n"}]},"apps":[],"jobName":"paragraph_1510391055824_-2061919512","id":"20171108-145128_360271297","dateCreated":"2017-11-11T09:04:15+0000","dateStarted":"2017-11-11T09:14:45+0000","dateFinished":"2017-11-11T09:14:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14055"},{"text":"%md\n### Prepare data - Splitting data into train and validation with features","user":"anonymous","dateUpdated":"2017-11-11T09:31:14+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","results":{},"enabled":true,"editorSetting":{"language":"markdown","editOnDblClick":true},"editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Prepare data - Splitting data into train and validation with features</h3>\n"}]},"apps":[],"jobName":"paragraph_1510391055824_-2061919512","id":"20171103-011055_1410887426","dateCreated":"2017-11-11T09:04:15+0000","dateStarted":"2017-11-11T09:09:52+0000","dateFinished":"2017-11-11T09:09:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14056"},{"text":"// Use first 5 weeks as training data\nval trainDataPrep = df\n    .filter(!$\"Week\".isin(8, 9))\n    .drop($\"Week\")\n\n// Use last 2 weeks as validation data\nval valDataPrep = df\n    .filter($\"Week\".isin(8, 9))\n    .drop($\"Week\")\n    \ntrainDataPrep.show(7)","user":"anonymous","dateUpdated":"2017-11-11T09:31:55+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false},"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ntrainDataPrep: org.apache.spark.sql.DataFrame = [SalesDepotID: float, SalesChannelID: float ... 4 more fields]\n\nvalDataPrep: org.apache.spark.sql.DataFrame = [SalesDepotID: float, SalesChannelID: float ... 4 more fields]\n+------------+--------------+-------+---------+---------+------+\n|SalesDepotID|SalesChannelID|RouteID| ClientID|ProductID|Demand|\n+------------+--------------+-------+---------+---------+------+\n|      1967.0|           1.0| 2005.0|2383837.0|  49920.0|   1.0|\n|      1967.0|           1.0| 2005.0|2387922.0|  46231.0|   2.0|\n|      1967.0|           1.0| 2005.0|2387922.0|  46232.0|   2.0|\n|      1967.0|           1.0| 2005.0|2435852.0|   4102.0|   2.0|\n|      1967.0|           1.0| 2005.0|2435852.0|  35457.0|   3.0|\n|      1967.0|           1.0| 2005.0|2435852.0|  36538.0|   4.0|\n|      1967.0|           1.0| 2005.0|2435852.0|  37059.0|   6.0|\n+------------+--------------+-------+---------+---------+------+\nonly showing top 7 rows\n\n"}]},"apps":[],"jobName":"paragraph_1510391055824_-2061919512","id":"20171103-011135_965466670","dateCreated":"2017-11-11T09:04:15+0000","dateStarted":"2017-11-11T09:31:55+0000","dateFinished":"2017-11-11T09:31:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14057"},{"text":"%md\n### Build ML Model - RandomForest","user":"anonymous","dateUpdated":"2017-11-11T09:38:02+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Build ML Model - RandomForest</h3>\n"}]},"apps":[],"jobName":"paragraph_1510391055825_-2062304261","id":"20171103-011517_171780742","dateCreated":"2017-11-11T09:04:15+0000","dateStarted":"2017-11-11T09:38:02+0000","dateFinished":"2017-11-11T09:38:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14058"},{"text":"import org.apache.spark.ml.evaluation.RegressionEvaluator\nimport org.apache.spark.ml.regression.{RandomForestRegressionModel, RandomForestRegressor}\nimport org.apache.spark.ml.feature.VectorAssembler\n\n// Index features\nval assembler = new VectorAssembler()\n  .setInputCols(Array(\"SalesDepotID\", \"SalesChannelID\", \"RouteID\", \"ClientID\", \"ProductID\"))\n  .setOutputCol(\"assembledFeatures\")\n\n// Train Data\nval trainData = assembler\n    .transform(trainDataPrep.limit(1000000))\n    .show()","user":"anonymous","dateUpdated":"2017-11-11T09:51:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.ml.evaluation.RegressionEvaluator\n\nimport org.apache.spark.ml.regression.{RandomForestRegressionModel, RandomForestRegressor}\n\nimport org.apache.spark.ml.feature.VectorAssembler\n\nassembler: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_c8357f30bfb5\n+------------+--------------+-------+---------+---------+------+--------------------+\n|SalesDepotID|SalesChannelID|RouteID| ClientID|ProductID|Demand|   assembledFeatures|\n+------------+--------------+-------+---------+---------+------+--------------------+\n|      1218.0|           1.0| 1608.0|2364198.0|  36003.0|  10.0|[1218.0,1.0,1608....|\n|      1218.0|           1.0| 1608.0|2364198.0|  40217.0|  11.0|[1218.0,1.0,1608....|\n|      1218.0|           1.0| 1608.0|2364198.0|  42869.0|  22.0|[1218.0,1.0,1608....|\n|      1218.0|           1.0| 1608.0|2364198.0|  44859.0|  25.0|[1218.0,1.0,1608....|\n|      1218.0|           1.0| 1608.0|2364198.0|  47124.0|   5.0|[1218.0,1.0,1608....|\n|      1218.0|           1.0| 1608.0|3966505.0|     72.0|   8.0|[1218.0,1.0,1608....|\n|      1218.0|           1.0| 1608.0|3966505.0|    323.0|   2.0|[1218.0,1.0,1608....|\n|      1218.0|           1.0| 1608.0|3966505.0|    325.0|   1.0|[1218.0,1.0,1608....|\n|      1218.0|           1.0| 1608.0|3966505.0|   2505.0|   2.0|[1218.0,1.0,1608....|\n|      1218.0|           1.0| 1608.0|3966505.0|   3609.0|   2.0|[1218.0,1.0,1608....|\n|      1218.0|           1.0| 1608.0|3966505.0|   4259.0|   1.0|[1218.0,1.0,1608....|\n|      1218.0|           1.0| 1608.0|3966505.0|   4280.0|   8.0|[1218.0,1.0,1608....|\n|      1218.0|           1.0| 1608.0|3966505.0|   9217.0|   4.0|[1218.0,1.0,1608....|\n|      1218.0|           1.0| 1608.0|3966505.0|  30215.0|   2.0|[1218.0,1.0,1608....|\n|      1218.0|           1.0| 1608.0|3966505.0|  30415.0|   6.0|[1218.0,1.0,1608....|\n|      1218.0|           1.0| 1608.0|3966505.0|  36003.0|   4.0|[1218.0,1.0,1608....|\n|      1218.0|           1.0| 1608.0|3966505.0|  40217.0|   2.0|[1218.0,1.0,1608....|\n|      1218.0|           1.0| 1608.0|4111345.0|    303.0|  17.0|[1218.0,1.0,1608....|\n|      1218.0|           1.0| 1608.0|4111345.0|    323.0|  10.0|[1218.0,1.0,1608....|\n|      1218.0|           1.0| 1608.0|4111345.0|    325.0|   6.0|[1218.0,1.0,1608....|\n+------------+--------------+-------+---------+---------+------+--------------------+\nonly showing top 20 rows\n\n\ntrainData: Unit = ()\n"}]},"apps":[],"jobName":"paragraph_1510393458021_1763686942","id":"20171111-094418_1983379275","dateCreated":"2017-11-11T09:44:18+0000","dateStarted":"2017-11-11T09:51:26+0000","dateFinished":"2017-11-11T09:51:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14059"},{"text":"import org.apache.spark.ml.evaluation.RegressionEvaluator\nimport org.apache.spark.ml.regression.{RandomForestRegressionModel, RandomForestRegressor}\nimport org.apache.spark.ml.feature.VectorAssembler\n\n// Index features\nval assembler = new VectorAssembler()\n  .setInputCols(Array(\"SalesDepotID\", \"SalesChannelID\", \"RouteID\", \"ClientID\", \"ProductID\"))\n  .setOutputCol(\"assembledFeatures\")\n\n// Train Data\nval trainData = assembler\n    .transform(trainDataPrep)\n    .select(\n        \"assembledFeatures\",\n        \"Demand\"\n    )\n    .repartition(100)\n\n// Validation Data\nval valData = assembler\n    .transform(valDataPrep)\n    .select(\n        \"assembledFeatures\",\n        \"Demand\"\n    )","user":"anonymous","dateUpdated":"2017-11-11T10:27:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false},"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.ml.evaluation.RegressionEvaluator\n\nimport org.apache.spark.ml.regression.{RandomForestRegressionModel, RandomForestRegressor}\n\nimport org.apache.spark.ml.feature.VectorAssembler\n\nassembler: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_ce6c55bd40c1\n\ntrainData: org.apache.spark.sql.DataFrame = [assembledFeatures: vector, Demand: float]\n\nvalData: org.apache.spark.sql.DataFrame = [assembledFeatures: vector, Demand: float]\n"}]},"apps":[],"jobName":"paragraph_1510391055825_-2062304261","id":"20171103-014037_846422168","dateCreated":"2017-11-11T09:04:15+0000","dateStarted":"2017-11-11T10:00:21+0000","dateFinished":"2017-11-11T10:00:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14060"},{"text":"data.limit(1000).select($\"ProductID\", $\"Week\", $\"Demand\")\n        .registerTempTable(\"mytable1\")","user":"anonymous","dateUpdated":"2017-11-11T11:14:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1510396360430_-482552710","id":"20171111-103240_297750604","dateCreated":"2017-11-11T10:32:40+0000","dateStarted":"2017-11-11T10:50:25+0000","dateFinished":"2017-11-11T10:50:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14061"},{"text":"%sql\nSELECT Demand, Week from mytable1","user":"anonymous","dateUpdated":"2017-11-11T11:17:31+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"scatterChart","height":300,"optionOpen":true,"setting":{"lineChart":{},"multiBarChart":{},"stackedAreaChart":{"style":"expand"}},"commonSetting":{},"keys":[{"name":"Week","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"Demand","index":0,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","lineNumbers":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Demand\tWeek\n10\t6\n11\t6\n22\t6\n25\t6\n5\t6\n8\t6\n2\t6\n1\t6\n2\t6\n2\t6\n1\t6\n8\t6\n4\t6\n2\t6\n6\t6\n4\t6\n2\t6\n17\t6\n10\t6\n6\t6\n6\t6\n6\t6\n10\t6\n8\t6\n5\t6\n5\t6\n6\t6\n9\t6\n4\t6\n9\t6\n1\t6\n2\t6\n2\t6\n5\t6\n2\t6\n2\t6\n3\t6\n3\t6\n4\t6\n2\t6\n5\t6\n5\t6\n2\t6\n4\t6\n10\t6\n5\t6\n3\t6\n2\t6\n4\t6\n2\t6\n5\t6\n2\t6\n2\t6\n8\t6\n4\t6\n2\t6\n3\t6\n2\t6\n2\t6\n2\t6\n2\t6\n2\t6\n2\t6\n5\t6\n2\t6\n4\t6\n2\t6\n3\t6\n3\t6\n10\t6\n6\t6\n5\t6\n9\t6\n12\t6\n0\t6\n3\t6\n4\t6\n2\t6\n10\t6\n5\t6\n6\t6\n5\t6\n6\t6\n16\t6\n13\t6\n14\t6\n3\t6\n7\t6\n3\t6\n8\t6\n200\t6\n4\t6\n5\t6\n9\t6\n3\t6\n2\t6\n1\t6\n2\t6\n3\t6\n3\t6\n3\t6\n2\t6\n9\t6\n20\t6\n1\t6\n6\t6\n1\t6\n1\t6\n1\t6\n1\t6\n4\t6\n2\t6\n6\t6\n7\t6\n1\t6\n80\t6\n1\t6\n2\t6\n1\t6\n1\t6\n1\t6\n2\t6\n3\t6\n7\t6\n2\t6\n2\t6\n2\t6\n3\t6\n3\t6\n7\t6\n5\t6\n3\t6\n10\t6\n2\t6\n2\t6\n10\t6\n6\t6\n2\t6\n2\t6\n4\t6\n2\t6\n13\t6\n1\t6\n10\t6\n6\t6\n4\t6\n2\t6\n1\t6\n11\t6\n5\t6\n3\t6\n4\t6\n2\t6\n1\t6\n7\t6\n2\t6\n5\t6\n2\t6\n8\t6\n6\t6\n2\t6\n3\t6\n4\t6\n2\t6\n5\t6\n9\t6\n19\t6\n15\t6\n8\t6\n2\t6\n4\t6\n3\t6\n3\t6\n2\t6\n5\t6\n12\t6\n280\t6\n2\t6\n1\t6\n2\t6\n2\t6\n4\t6\n1\t6\n2\t6\n1\t6\n7\t6\n5\t6\n40\t6\n2\t6\n10\t6\n4\t6\n2\t6\n2\t6\n3\t6\n12\t6\n5\t6\n9\t6\n200\t6\n12\t6\n15\t6\n3\t6\n3\t6\n4\t6\n2\t6\n4\t6\n4\t6\n5\t6\n4\t6\n4\t6\n8\t6\n9\t6\n9\t6\n4\t6\n6\t6\n7\t6\n5\t6\n11\t6\n8\t6\n4\t6\n1\t6\n1\t6\n3\t6\n1\t6\n3\t6\n3\t6\n2\t6\n3\t6\n9\t6\n1\t6\n3\t6\n2\t6\n6\t6\n1\t6\n7\t6\n5\t6\n3\t6\n9\t6\n1\t6\n4\t6\n6\t6\n4\t6\n5\t6\n3\t6\n2\t6\n2\t6\n5\t6\n1\t6\n5\t6\n1\t6\n0\t6\n0\t6\n1\t6\n0\t6\n0\t6\n3\t6\n1\t6\n0\t6\n0\t6\n0\t6\n1\t6\n6\t6\n10\t6\n3\t6\n5\t6\n15\t6\n1\t6\n2\t6\n1\t6\n7\t6\n3\t6\n2\t6\n3\t6\n3\t6\n3\t6\n2\t6\n5\t6\n1\t6\n2\t6\n2\t6\n12\t6\n6\t6\n1\t6\n2\t6\n4\t6\n4\t6\n2\t6\n12\t6\n2\t6\n1\t6\n2\t6\n2\t6\n5\t6\n22\t6\n7\t6\n8\t6\n10\t6\n5\t6\n3\t6\n5\t6\n4\t6\n6\t6\n5\t6\n7\t6\n4\t6\n6\t6\n4\t6\n4\t6\n5\t6\n4\t6\n5\t6\n14\t6\n7\t6\n2\t6\n8\t6\n2\t6\n4\t6\n4\t6\n6\t6\n120\t6\n2\t6\n1\t6\n6\t6\n8\t6\n1\t6\n3\t6\n11\t6\n1\t6\n3\t6\n4\t6\n12\t6\n3\t6\n160\t6\n4\t6\n6\t6\n8\t6\n7\t6\n8\t6\n7\t6\n5\t6\n7\t6\n5\t6\n6\t6\n3\t6\n1\t6\n7\t6\n5\t6\n6\t6\n2\t6\n2\t6\n3\t6\n2\t6\n3\t6\n1\t6\n0\t6\n3\t6\n2\t6\n4\t6\n7\t6\n2\t6\n3\t6\n4\t6\n4\t6\n1\t6\n1\t6\n2\t6\n8\t6\n2\t6\n1\t6\n7\t6\n2\t6\n5\t6\n1\t6\n4\t6\n3\t6\n3\t6\n3\t6\n5\t6\n4\t6\n0\t6\n2\t6\n2\t6\n2\t6\n10\t6\n1\t6\n6\t6\n5\t6\n1\t6\n4\t6\n9\t6\n17\t6\n7\t6\n2\t6\n8\t6\n3\t6\n15\t6\n5\t6\n2\t6\n200\t6\n4\t6\n2\t6\n1\t6\n1\t6\n4\t6\n3\t6\n10\t6\n4\t6\n1\t6\n120\t6\n6\t6\n3\t6\n5\t6\n5\t6\n4\t6\n6\t6\n1\t6\n2\t6\n3\t6\n8\t6\n3\t6\n11\t6\n6\t6\n2\t6\n7\t6\n2\t6\n1\t6\n6\t6\n8\t6\n4\t6\n8\t6\n4\t6\n1\t6\n11\t6\n8\t6\n5\t6\n2\t6\n11\t6\n11\t6\n7\t6\n6\t6\n4\t6\n0\t6\n7\t6\n4\t6\n1\t6\n1\t6\n8\t6\n80\t6\n1\t6\n10\t6\n5\t6\n4\t6\n3\t6\n4\t6\n5\t6\n10\t6\n3\t6\n4\t6\n4\t6\n5\t6\n2\t6\n9\t6\n10\t6\n1\t6\n1\t6\n2\t6\n2\t6\n2\t6\n3\t6\n8\t6\n2\t6\n8\t6\n2\t6\n3\t6\n4\t6\n5\t6\n1\t6\n5\t6\n1\t6\n7\t6\n4\t6\n6\t6\n2\t6\n1\t6\n5\t6\n2\t6\n4\t6\n1\t6\n1\t6\n1\t6\n3\t6\n4\t6\n1\t6\n2\t6\n3\t6\n3\t6\n1\t6\n1\t6\n3\t6\n1\t6\n2\t6\n2\t6\n40\t6\n7\t6\n5\t6\n4\t6\n5\t6\n2\t6\n3\t6\n8\t6\n9\t6\n8\t6\n2\t6\n4\t6\n8\t6\n40\t6\n5\t6\n11\t6\n2\t6\n2\t6\n1\t6\n8\t6\n2\t6\n6\t6\n8\t6\n1\t6\n6\t6\n4\t6\n8\t6\n10\t6\n2\t6\n80\t6\n1\t6\n19\t6\n6\t6\n4\t6\n3\t6\n6\t6\n2\t6\n15\t6\n2\t6\n7\t6\n5\t6\n2\t6\n2\t6\n1\t6\n13\t6\n6\t6\n12\t6\n5\t6\n7\t6\n5\t6\n5\t6\n2\t6\n8\t6\n3\t6\n5\t6\n2\t6\n2\t6\n7\t6\n10\t6\n6\t6\n8\t6\n3\t6\n4\t6\n1\t6\n9\t6\n6\t6\n3\t6\n6\t6\n9\t6\n3\t6\n6\t6\n8\t6\n5\t6\n7\t6\n4\t6\n6\t6\n1\t6\n7\t6\n3\t6\n11\t6\n5\t6\n240\t6\n1\t6\n4\t6\n1\t6\n3\t6\n1\t6\n6\t6\n4\t6\n2\t6\n7\t6\n2\t6\n2\t6\n2\t6\n3\t6\n8\t6\n2\t6\n5\t6\n5\t6\n10\t6\n8\t6\n7\t6\n6\t6\n12\t6\n6\t6\n9\t6\n10\t6\n8\t6\n9\t6\n5\t6\n8\t6\n6\t6\n4\t6\n10\t6\n5\t6\n10\t6\n200\t6\n2\t6\n11\t6\n5\t6\n1\t6\n1\t6\n3\t6\n5\t6\n3\t6\n7\t6\n8\t6\n2\t6\n1\t6\n2\t6\n8\t6\n1\t6\n4\t6\n4\t6\n2\t6\n6\t6\n4\t6\n3\t6\n3\t6\n2\t6\n1\t6\n2\t6\n2\t6\n2\t6\n2\t6\n2\t6\n6\t6\n7\t6\n5\t6\n3\t6\n8\t6\n6\t6\n11\t6\n6\t6\n18\t6\n5\t6\n0\t6\n5\t6\n1\t6\n8\t6\n4\t6\n3\t6\n7\t6\n8\t6\n6\t6\n11\t6\n2\t6\n1\t6\n5\t6\n1\t6\n2\t6\n3\t6\n6\t6\n6\t6\n4\t6\n2\t6\n10\t6\n3\t6\n3\t6\n3\t6\n1\t6\n6\t6\n5\t6\n120\t6\n4\t6\n9\t6\n1\t6\n3\t6\n2\t6\n3\t6\n4\t6\n4\t6\n10\t6\n8\t6\n8\t6\n2\t6\n2\t6\n9\t6\n3\t6\n2\t6\n80\t6\n1\t6\n1\t6\n1\t6\n1\t6\n2\t6\n1\t6\n9\t6\n20\t6\n9\t6\n9\t6\n6\t6\n11\t6\n25\t6\n20\t6\n13\t6\n22\t6\n7\t6\n2\t6\n5\t6\n12\t6\n2\t6\n2\t6\n4\t6\n1\t6\n8\t6\n6\t6\n30\t6\n3\t6\n2\t6\n160\t6\n10\t6\n3\t6\n5\t6\n4\t6\n1\t6\n2\t6\n6\t6\n4\t6\n1\t6\n6\t6\n6\t6\n3\t6\n2\t6\n1\t6\n3\t6\n2\t6\n2\t6\n2\t6\n2\t6\n1\t6\n5\t6\n4\t6\n5\t6\n9\t6\n4\t6\n2\t6\n1\t6\n6\t6\n4\t6\n8\t6\n4\t6\n1\t6\n6\t6\n0\t6\n4\t6\n11\t6\n8\t6\n2\t6\n4\t6\n5\t6\n4\t6\n2\t6\n2\t6\n1\t6\n3\t6\n3\t6\n19\t6\n5\t6\n4\t6\n2\t6\n2\t6\n3\t6\n6\t6\n6\t6\n3\t6\n3\t6\n1\t6\n1\t6\n5\t6\n80\t6\n5\t6\n9\t6\n2\t6\n2\t6\n1\t6\n2\t6\n2\t6\n11\t6\n11\t6\n5\t6\n5\t6\n5\t6\n2\t6\n8\t6\n5\t6\n3\t6\n3\t6\n10\t6\n6\t6\n5\t6\n2\t6\n3\t6\n4\t6\n5\t6\n8\t6\n2\t6\n5\t6\n2\t6\n1\t6\n1\t6\n2\t6\n3\t6\n1\t6\n3\t6\n4\t6\n3\t6\n5\t6\n3\t6\n3\t6\n3\t6\n5\t6\n3\t6\n3\t6\n8\t6\n3\t6\n2\t6\n3\t6\n2\t6\n8\t6\n5\t6\n2\t6\n2\t6\n2\t6\n2\t6\n5\t6\n2\t6\n2\t6\n3\t6\n4\t6\n6\t6\n4\t6\n2\t6\n5\t6\n2\t6\n2\t6\n2\t6\n4\t6\n3\t6\n3\t6\n2\t6\n4\t6\n2\t6\n2\t6\n2\t6\n4\t6\n3\t6\n5\t6\n2\t6\n3\t6\n4\t6\n3\t6\n1\t6\n1\t6\n1\t6\n3\t6\n3\t6\n0\t6\n2\t6\n4\t6\n1\t6\n1\t6\n5\t6\n2\t6\n2\t6\n3\t6\n2\t6\n5\t6\n2\t6\n2\t6\n2\t6\n2\t6\n2\t6\n2\t6\n3\t6\n1\t6\n1\t6\n7\t6\n10\t6\n2\t6\n3\t6\n3\t6\n2\t6\n1\t6\n3\t6\n6\t6\n0\t6\n6\t6\n40\t6\n0\t6\n4\t6\n2\t6\n3\t6\n3\t6\n3\t6\n2\t6\n5\t6\n3\t6\n1\t6\n3\t6\n4\t6\n2\t6\n3\t6\n4\t6\n3\t6\n5\t6\n3\t6\n4\t6\n6\t6\n2\t6\n2\t6\n6\t6\n7\t6\n4\t6\n6\t6\n2\t6\n2\t6\n1\t6\n2\t6\n3\t6\n4\t6\n1\t6\n4\t6\n2\t6\n3\t6\n2\t6\n2\t6\n2\t6\n2\t6\n1\t6\n6\t6\n3\t6\n2\t6\n2\t6\n6\t6\n5\t6\n2\t6\n2\t6\n2\t6\n2\t6\n2\t6\n3\t6\n2\t6\n5\t6\n1\t6\n3\t6\n5\t6\n2\t6\n3\t6\n2\t6\n2\t6\n2\t6\n2\t6\n2\t6\n3\t6\n4\t6\n4\t6\n3\t6\n2\t6\n2\t6\n2\t6\n2\t6\n4\t6\n6\t6\n3\t6\n7\t6\n6\t6\n8\t6\n4\t6\n4\t6\n10\t6\n4\t6\n5\t6\n6\t6\n5\t6\n1\t6\n8\t6\n2\t6\n3\t6\n"}]},"apps":[],"jobName":"paragraph_1510396444606_-1984738299","id":"20171111-103404_2078035862","dateCreated":"2017-11-11T10:34:04+0000","dateStarted":"2017-11-11T11:15:40+0000","dateFinished":"2017-11-11T11:15:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14062"},{"text":"data.groupBy($\"ClientID\", $\"ProductID\")\n    .pivot(\"Week\")\n    .agg(mean($\"Demand\"))\n    .show(9)","user":"anonymous","dateUpdated":"2017-11-11T11:27:05+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+---------+----+----+----+----+----+----+----+\n|ClientID|ProductID|   3|   4|   5|   6|   7|   8|   9|\n+--------+---------+----+----+----+----+----+----+----+\n|  242132|    31298|null| 6.0| 2.0| 6.0| 4.0| 4.0|null|\n|  102158|     1238|null|null|null| 2.0| 0.0| 1.0| 1.0|\n| 1025611|    40217|null|null|null|null| 4.0|null|null|\n| 1025936|     1220|11.0|23.0|12.0|24.0|16.0|12.0|null|\n|  103710|    35651|null|10.0| 5.0|10.0|15.0| 5.0|10.0|\n| 1046689|      325| 3.0|null|null| 2.0| 5.0| 4.0| 5.0|\n|  105236|     1250|null| 3.0|null|null| 6.0| 2.0| 4.0|\n|  105434|     1284| 4.0| 5.0|12.0|10.0|13.0| 4.0|14.0|\n| 1077821|    30555|null|null|null|null|null| 1.0| 2.0|\n+--------+---------+----+----+----+----+----+----+----+\nonly showing top 9 rows\n\n"}]},"apps":[],"jobName":"paragraph_1510399557436_-2023742433","id":"20171111-112557_1173623402","dateCreated":"2017-11-11T11:25:57+0000","dateStarted":"2017-11-11T11:27:05+0000","dateFinished":"2017-11-11T11:28:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14063"},{"text":"\n// Train a RandomForest regression model\nval rf = new RandomForestRegressor()\n  .setLabelCol(\"Demand\")\n  .setFeaturesCol(\"assembledFeatures\")\n  .setnumTrees(100)\n  .setMaxBins(32)\n\n// Train model\nval model = rf.fit(trainData)\n","user":"anonymous","dateUpdated":"2017-11-11T12:04:49+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false},"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nrf: org.apache.spark.ml.regression.RandomForestRegressor = rfr_245f1e2773ee\n\nmodel: org.apache.spark.ml.regression.RandomForestRegressionModel = RandomForestRegressionModel (uid=rfr_245f1e2773ee) with 20 trees\n"}]},"apps":[],"jobName":"paragraph_1510391055825_-2062304261","id":"20171108-150536_1692339097","dateCreated":"2017-11-11T09:04:15+0000","dateStarted":"2017-11-11T10:00:30+0000","dateFinished":"2017-11-11T10:01:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14064"},{"text":"// Make predictions\nval predictions = model.transform(valData)\n\n// Select example rows to display\npredictions.show(5)\n","user":"anonymous","dateUpdated":"2017-11-11T10:03:41+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false},"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\npredictions: org.apache.spark.sql.DataFrame = [assembledFeatures: vector, Demand: float ... 1 more field]\n+--------------------+------+-----------------+\n|   assembledFeatures|Demand|       prediction|\n+--------------------+------+-----------------+\n|[1531.0,1.0,2113....|   1.0|5.580466004940307|\n|[1531.0,1.0,2113....|   5.0|5.580466004940307|\n|[1531.0,1.0,2113....|   4.0|5.569024534419404|\n|[1531.0,1.0,2113....|   8.0|5.569024534419404|\n|[1531.0,1.0,2113....|   4.0|5.569024534419404|\n+--------------------+------+-----------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1510391055825_-2062304261","id":"20171108-151139_831636425","dateCreated":"2017-11-11T09:04:15+0000","dateStarted":"2017-11-11T10:03:41+0000","dateFinished":"2017-11-11T10:03:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14065"},{"text":"%md\n### Evaluate Model - RMSE","user":"anonymous","dateUpdated":"2017-11-11T10:04:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Evaluate Model - RMSE</h3>\n"}]},"apps":[],"jobName":"paragraph_1510391055825_-2062304261","id":"20171103-011539_1334990513","dateCreated":"2017-11-11T09:04:15+0000","dateStarted":"2017-11-11T10:04:34+0000","dateFinished":"2017-11-11T10:04:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14066"},{"text":"// Evaluate model\nval evaluator = new RegressionEvaluator()\n  .setLabelCol(\"Demand\")\n  .setPredictionCol(\"prediction\")\n  .setMetricName(\"rmse\")\nval rmse = evaluator.evaluate(predictions)\n\nprintln(\"Root Mean Squared Error (RMSE) on validation data = \" + rmse)\n","user":"anonymous","dateUpdated":"2017-11-11T10:05:19+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false},"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nevaluator: org.apache.spark.ml.evaluation.RegressionEvaluator = regEval_5dbef4926f7d\n\nrmse: Double = 52.08608480189111\nRoot Mean Squared Error (RMSE) on validation data = 52.08608480189111\n"}]},"apps":[],"jobName":"paragraph_1510391055826_-2061150014","id":"20171103-014605_1511230027","dateCreated":"2017-11-11T09:04:15+0000","dateStarted":"2017-11-11T10:05:19+0000","dateFinished":"2017-11-11T10:06:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14067"},{"text":"%md\n### Feature Engineering - Count features\neg: count of ProductID","dateUpdated":"2017-11-11T09:31:15+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","results":{},"enabled":true,"editorSetting":{"language":"markdown","editOnDblClick":true},"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Feature Engineering - Count features</h3>\n<p>eg: count of ProductID</p>\n"}]},"apps":[],"jobName":"paragraph_1510391055827_-2061534763","id":"20171103-011751_792924665","dateCreated":"2017-11-11T09:04:15+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14068"},{"text":"val product_count = df\n    .groupBy($\"ProductID\")\n    .count()\n    \nval df2 = df\n    .join(product_count, Seq(\"ProductID\"), \"inner\")\n\ndf2.show","user":"anonymous","dateUpdated":"2017-11-11T11:38:24+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false},"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nproduct_count: org.apache.spark.sql.DataFrame = [ProductID: float, count: bigint]\n\ndf2: org.apache.spark.sql.DataFrame = [ProductID: float, Week: float ... 6 more fields]\n+---------+----+------------+--------------+-------+---------+------+-----+\n|ProductID|Week|SalesDepotID|SalesChannelID|RouteID| ClientID|Demand|count|\n+---------+----+------------+--------------+-------+---------+------+-----+\n|    714.0| 6.0|      1239.0|           1.0| 1025.0| 108322.0|   3.0|  820|\n|    714.0| 6.0|      1239.0|           1.0| 1025.0| 184834.0|  14.0|  820|\n|    714.0| 6.0|      1239.0|           1.0| 1025.0| 221805.0|   2.0|  820|\n|    714.0| 6.0|      1239.0|           1.0| 1025.0| 221970.0|   1.0|  820|\n|    714.0| 6.0|      1239.0|           1.0| 1025.0| 290608.0|  31.0|  820|\n|    714.0| 6.0|      1239.0|           1.0| 1025.0| 534163.0|   6.0|  820|\n|    714.0| 6.0|      1239.0|           1.0| 1025.0| 842107.0|   1.0|  820|\n|    714.0| 6.0|      1239.0|           1.0| 1025.0|4297345.0|   7.0|  820|\n|    714.0| 6.0|      1239.0|           1.0| 1025.0|4307111.0|   1.0|  820|\n|    714.0| 6.0|      1259.0|           6.0| 3234.0|4382853.0|   1.0|  820|\n|    714.0| 6.0|      1259.0|           6.0| 3234.0|4491952.0|   1.0|  820|\n|    714.0| 6.0|      1259.0|           7.0| 3335.0|1218356.0|   4.0|  820|\n|    714.0| 6.0|      1259.0|           7.0| 3344.0|1836766.0|   6.0|  820|\n|    714.0| 6.0|      1259.0|           7.0| 3344.0|2391826.0|   9.0|  820|\n|    714.0| 6.0|      1259.0|           7.0| 3349.0|4354559.0|  16.0|  820|\n|    714.0| 6.0|      1259.0|           7.0| 3356.0| 110787.0|   4.0|  820|\n|    714.0| 6.0|      1259.0|           8.0| 3402.0| 856474.0|   5.0|  820|\n|    714.0| 6.0|      1259.0|          11.0| 3502.0|2449896.0|   2.0|  820|\n|    714.0| 6.0|      1279.0|           7.0| 3323.0|4471234.0|  30.0|  820|\n|    714.0| 6.0|      1279.0|           7.0| 3328.0|4428788.0|  12.0|  820|\n+---------+----+------------+--------------+-------+---------+------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1510391055827_-2061534763","id":"20171103-011914_1186536867","dateCreated":"2017-11-11T09:04:15+0000","dateStarted":"2017-11-11T11:38:24+0000","dateFinished":"2017-11-11T11:39:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14069"},{"text":"%md\n### Feature Engineering - Lag features\neg: Demand of Client and Product in previous week","dateUpdated":"2017-11-11T09:31:15+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Feature Engineering - Lag features</h3>\n<p>eg: Demand of Client and Product in previous week</p>\n"}]},"apps":[],"jobName":"paragraph_1510391055827_-2061534763","id":"20171103-012331_2113070645","dateCreated":"2017-11-11T09:04:15+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14070"},{"text":"import org.apache.spark.sql.functions.{lead, lag}\nimport org.apache.spark.sql.expressions.Window\n\n// Previous week demand of product for client\nval prev_df = df\n    .groupBy($\"ProductID\", $\"ClientID\", $\"Week\")\n    .agg(\n        sum($\"Demand\") as \"Prev_Demand\"\n    )\n    .withColumn(\"Week\", $\"Week\" + lit(1))\n    \nval df3 = df\n    .join(prev_df, Seq(\"ProductID\", \"ClientID\", \"Week\"), \"left\")\n","dateUpdated":"2017-11-11T09:31:15+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false},"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.sql.functions.{lead, lag}\n\nimport org.apache.spark.sql.expressions.Window\n\nprev_df: org.apache.spark.sql.DataFrame = [ProductID: float, ClientID: float ... 2 more fields]\n\ndf3: org.apache.spark.sql.DataFrame = [ProductID: float, ClientID: float ... 6 more fields]\n"}]},"apps":[],"jobName":"paragraph_1510391055828_-2063458508","id":"20171103-034903_2044464037","dateCreated":"2017-11-11T09:04:15+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14071"},{"text":"// Previous occurrence of demand of product in any week\nval df4 = df\n    .withColumn(\"Prev_Demand2\", lag($\"Demand\", 1).over(Window.partitionBy(\"ProductID\", \"ClientID\").orderBy(\"Week\")))\n    ","dateUpdated":"2017-11-11T11:40:28+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false},"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ndf4: org.apache.spark.sql.DataFrame = [Week: float, SalesDepotID: float ... 6 more fields]\n"}]},"apps":[],"jobName":"paragraph_1510391055828_-2063458508","id":"20171109-074755_1659039894","dateCreated":"2017-11-11T09:04:15+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14072"},{"text":"df4.show","dateUpdated":"2017-11-11T09:31:15+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false},"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+------------+--------------+-------+--------+---------+------+------------+\n|Week|SalesDepotID|SalesChannelID|RouteID|ClientID|ProductID|Demand|Prev_Demand2|\n+----+------------+--------------+-------+--------+---------+------+------------+\n| 6.0|      2013.0|           1.0| 5008.0|  6544.0|     72.0|   2.0|        null|\n| 7.0|      2013.0|           1.0| 5008.0|  6544.0|     72.0|   2.0|         2.0|\n| 8.0|      2013.0|           1.0| 5008.0|  6544.0|     72.0|   1.0|         2.0|\n| 9.0|      2013.0|           1.0| 5008.0|  6544.0|     72.0|   3.0|         1.0|\n| 5.0|      1227.0|           1.0| 1611.0|  8055.0|     72.0|   2.0|        null|\n| 6.0|      1227.0|           1.0| 1611.0|  8055.0|     72.0|   5.0|         2.0|\n| 7.0|      1227.0|           1.0| 1611.0|  8055.0|     72.0|   5.0|         5.0|\n| 8.0|      1227.0|           1.0| 1611.0|  8055.0|     72.0|   5.0|         5.0|\n| 9.0|      1227.0|           1.0| 1611.0|  8055.0|     72.0|   5.0|         5.0|\n| 9.0|      1227.0|           1.0| 1615.0|  8552.0|     72.0|   5.0|        null|\n| 4.0|      1218.0|           1.0| 1607.0| 17985.0|     72.0|   9.0|        null|\n| 5.0|      1218.0|           1.0| 1607.0| 17985.0|     72.0|  10.0|         9.0|\n| 6.0|      1218.0|           1.0| 1607.0| 17985.0|     72.0|   8.0|        10.0|\n| 7.0|      1218.0|           1.0| 1607.0| 17985.0|     72.0|   4.0|         8.0|\n| 8.0|      1218.0|           1.0| 1607.0| 17985.0|     72.0|   5.0|         4.0|\n| 9.0|      1218.0|           1.0| 1607.0| 17985.0|     72.0|   8.0|         5.0|\n| 3.0|      1218.0|           1.0| 1604.0| 18258.0|     72.0|   3.0|        null|\n| 4.0|      1218.0|           1.0| 1604.0| 18258.0|     72.0|   4.0|         3.0|\n| 5.0|      1218.0|           1.0| 1604.0| 18258.0|     72.0|   4.0|         4.0|\n| 6.0|      1218.0|           1.0| 1604.0| 18258.0|     72.0|   4.0|         4.0|\n+----+------------+--------------+-------+--------+---------+------+------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1510391055828_-2063458508","id":"20171109-074924_528442668","dateCreated":"2017-11-11T09:04:15+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14073"},{"text":"df3.show","dateUpdated":"2017-11-11T09:31:15+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false},"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+---------+----+------------+--------------+-------+------+-----------+\n|ProductID| ClientID|Week|SalesDepotID|SalesChannelID|RouteID|Demand|Prev_Demand|\n+---------+---------+----+------------+--------------+-------+------+-----------+\n|     53.0|3476372.0| 8.0|      1694.0|           4.0| 8502.0| 525.0|      321.0|\n|     72.0|   2437.0| 6.0|      2012.0|           1.0| 5015.0|  11.0|       null|\n|     72.0|   3424.0| 7.0|      2012.0|           1.0| 5014.0|   5.0|       null|\n|     72.0|   3473.0| 8.0|      2013.0|           1.0| 5005.0|   5.0|        5.0|\n|     72.0|   6284.0| 3.0|      2013.0|           1.0| 5004.0|   2.0|       null|\n|     72.0|   7545.0| 9.0|      2013.0|           1.0| 5008.0|   5.0|       null|\n|     72.0|   7918.0| 5.0|      1227.0|           1.0| 1613.0|   4.0|       null|\n|     72.0|  10120.0| 8.0|      2013.0|           1.0| 5005.0|   8.0|       10.0|\n|     72.0|  15545.0| 3.0|      2013.0|           1.0| 5012.0|   3.0|       null|\n|     72.0|  16459.0| 3.0|      1120.0|           1.0| 1607.0|  10.0|       null|\n|     72.0|  16467.0| 8.0|      1116.0|           1.0| 1609.0|   7.0|       null|\n|     72.0|  16837.0| 5.0|      1218.0|           1.0| 1607.0|  50.0|       38.0|\n|     72.0|  18508.0| 3.0|      1218.0|           1.0| 1608.0|   6.0|       null|\n|     72.0|  18726.0| 8.0|      1120.0|           1.0| 1605.0|   8.0|        8.0|\n|     72.0|  18949.0| 4.0|      1218.0|           1.0| 1604.0|   8.0|        5.0|\n|     72.0|  20301.0| 5.0|      3213.0|           1.0| 1660.0|   6.0|       10.0|\n|     72.0|  20508.0| 6.0|      1120.0|           1.0| 1601.0|   3.0|        3.0|\n|     72.0|  21653.0| 4.0|      1113.0|           1.0| 1606.0|  10.0|        6.0|\n|     72.0|  21653.0| 9.0|      1113.0|           1.0| 1606.0|   6.0|       null|\n|     72.0|  21793.0| 4.0|      3213.0|           1.0| 1668.0|  24.0|       13.0|\n+---------+---------+----+------------+--------------+-------+------+-----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1510391055828_-2063458508","id":"20171109-075453_675519679","dateCreated":"2017-11-11T09:04:15+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14074"},{"text":"%md\n### Feature Engineering - Aggregate features\neg: Percentage change in sales, variance of demand in a route","dateUpdated":"2017-11-11T09:31:15+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","results":{},"enabled":true,"editorSetting":{"language":"markdown","editOnDblClick":true},"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Feature Engineering - Aggregate features</h3>\n<p>eg: Percentage change in sales, variance of demand in a route</p>\n"}]},"apps":[],"jobName":"paragraph_1510391055828_-2063458508","id":"20171103-024506_153450945","dateCreated":"2017-11-11T09:04:15+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14075"},{"text":"trainDataPrep.count","user":"anonymous","dateUpdated":"2017-11-11T10:10:43+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false},"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nres81: Long = 53364883\n"}]},"apps":[],"jobName":"paragraph_1510391055829_-2063843257","id":"20171108-164543_292927448","dateCreated":"2017-11-11T09:04:15+0000","dateStarted":"2017-11-11T10:10:43+0000","dateFinished":"2017-11-11T10:10:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14076"},{"text":"valDataPrep.count","user":"anonymous","dateUpdated":"2017-11-11T10:10:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nres82: Long = 20815581\n"}]},"apps":[],"jobName":"paragraph_1510395043305_1245085343","id":"20171111-101043_264687343","dateCreated":"2017-11-11T10:10:43+0000","dateStarted":"2017-11-11T10:10:52+0000","dateFinished":"2017-11-11T10:10:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14077"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1510395052297_1549067622","id":"20171111-101052_438657210","dateCreated":"2017-11-11T10:10:52+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:14078"}],"name":"Scala ML","id":"2CZ9TD5KX","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}